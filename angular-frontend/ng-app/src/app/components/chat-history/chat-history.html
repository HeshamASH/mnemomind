<div class="p-3 border-b">
  <button mat-flat-button color="primary" class="w-full" (click)="onNewChat()">
    <mat-icon>add</mat-icon>
    <span>New Chat</span>
  </button>
</div>
<mat-nav-list>
  <a mat-list-item *ngFor="let chat of chats$ | async" [activated]="(activeChatId$ | async) === chat.id" (click)="onSelectChat(chat.id)">
    <mat-icon matListItemIcon>chat</mat-icon>
    <div matListItemTitle>{{ chat.title }}</div>
    <div matListItemLine>{{ chat.messages.length }} messages</div>
    <button mat-icon-button (click)="onDeleteChat($event, chat.id)">
      <mat-icon>delete</mat-icon>
    </button>
  </a>
</mat-nav-list>
<div *ngIf="activeDataSource$ | async" class="mt-2 pt-2 border-t">
  <h3 class="px-3 text-xs font-semibold uppercase text-slate-500 dark:text-slate-400 mb-2">
    File Explorer
  </h3>
  <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="example-tree">
    <mat-nested-tree-node *matTreeNodeDef="let node">
      <li class="mat-tree-node">
        <button mat-icon-button disabled></button>
        <a (click)="onSelectFile(node.source!)">{{ node.name }}</a>
      </li>
    </mat-nested-tree-node>
    <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
      <li>
        <div class="mat-tree-node">
          <button mat-icon-button [attr.aria-label]="'Toggle ' + node.name" (click)="treeControl.toggle(node)">
            <mat-icon class="mat-icon-rtl-mirror">
              {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
            </mat-icon>
          </button>
          {{node.name}}
        </div>
        <ul [class.example-tree-invisible]="!treeControl.isExpanded(node)">
          <ng-container matTreeNodeOutlet></ng-container>
        </ul>
      </li>
    </mat-nested-tree-node>
  </mat-tree>
</div>
